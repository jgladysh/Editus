/** editus v0.0.1 **/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.editus=e()}}(function(){return function e(t,n,o){function i(d,a){if(!n[d]){if(!t[d]){var u="function"==typeof require&&require;if(!a&&u)return u(d,!0);if(r)return r(d,!0);var f=new Error("Cannot find module '"+d+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[d]={exports:{}};t[d][0].call(l.exports,function(e){var n=t[d][1][e];return i(n?n:e)},l,l.exports,e,t,n,o)}return n[d].exports}for(var r="function"==typeof require&&require,d=0;d<o.length;d++)i(o[d]);return i}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("./main").makeEditable,i=e("./undo_redo").initStack;createEditor=function(e){i(e),o(e)},n.createEditor=createEditor},{"./main":4,"./undo_redo":6}],2:[function(e,t,n){(function(e){"use strict";function t(e,t){for(var n=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,function(t){var n=document.createRange();return n.selectNode(t),n.compareBoundaryPoints(Range.END_TO_END,e)<1?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},!1),o=0;n.nextNode();)o+=n.currentNode.length;return 3===e.startContainer.nodeType&&(o+=e.startOffset),o}function o(e,t){function n(e){if(3===e.nodeType){var r=o+e.length;if(t>=o&&r>=t)throw window.getSelection().collapse(e,t-o),i;o=r}else for(var d=e.firstChild;d;)n(d),d=d.nextSibling}var o=0,i={};try{n(e)}catch(r){if(r!==i)throw r}}function i(){var e=window.getSelection().getRangeAt(0),t=document.createElement("span");t.className="anchor",e.insertNode(t);var n=$(".anchor").offset();return t.parentNode.removeChild($(".anchor")[0]),n}Object.defineProperty(n,"__esModule",{value:!0}),"undefined"!=typeof window?window.jquery:"undefined"!=typeof e?e.jquery:null,n.getCursorCoordinates=i,n.setCaretCharIndex=o,n.getCharacterOffsetWithin=t}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,n){(function(t){"use strict";function o(e){if(e.childNodes.length>0)for(var t=0;t<e.childNodes.length;t++)(e.childNodes[t].data&&""!==e.childNodes[t].data||"DIV"===e.childNodes[t].nodeName)&&o(e.childNodes[t]);else{var n=r(c,e);d(n)}}function i(e,t){for(var n,o=new RegExp("\\b"+e+"\\b((?!\\W(?=\\w))|(?=\\s))","gi"),i=[];null!==(n=o.exec(t));)i.push(n.index);return i}function r(e,t){for(var n=[],o=0;o<e.length;o++){var r=e[o],d=i(r,t.nodeValue);if(d.length>0){for(var a=[],u=0;u<d.length;u++){var f=document.createRange();f.setStart(t,d[u]),f.setEnd(t,d[u]+r.length),a[u]=f}n=n.concat(a)}}return n}function d(e){for(var t=0;t<e.length;t++){var n=document.createElement("span");n.className="highlighted",$(n).data("content",e[t].toString()),e[t].surroundContents(n)}}function a(e,t){var n=window.getSelection(),o=n.anchorNode,i=o.nextElementSibling,r=document.getElementById(t),d=n.baseNode.parentElement;if(o.length===n.anchorOffset&&i&&"SPAN"===i.nodeName&&($(i).contents().unwrap(),r.normalize(),u(!0)),"highlighted"===d.className||"highlighted"===n.baseNode.className)for(var a=n.getRangeAt(0),f=s(a,r),p=$(".highlighted"),g=0;g<p.length;g++){var h=$(p[g]).text();new RegExp(c.map(function(e){return"^"+e+"$"}).join("|"),"gi").test(h)||($(p[g]).contents().unwrap(),r.normalize(),13!==e.keyCode&&l(r,f))}}Object.defineProperty(n,"__esModule",{value:!0});var u=e("./main").setProcessing,f=e("./caret"),l=f.setCaretCharIndex,s=f.getCharacterOffsetWithin;"undefined"!=typeof window?window.jquery:"undefined"!=typeof t?t.jquery:null;var c=["create","experiment","assign","to","all","users","where","for","salt","new"];n.checkHighlighted=a,n.checkEveryTag=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./caret":2,"./main":4}],4:[function(e,t,n){(function(t){"use strict";function o(e){var t=new $.Deferred;if(v()&&(38===e.keyCode||40===e.keyCode||13===e.keyCode))return e.preventDefault(),k(e),t.reject();if(v()&&x(),e.shiftKey&&32===e.keyCode){e.preventDefault();var n=c();return C(n.top+25,n.left,f),t.reject()}return e.metaKey&&65!==e.keyCode&&88!==e.keyCode&&86!==e.keyCode&&67!==e.keyCode&&(e.preventDefault(),T(!0),e.metaKey&&90===e.keyCode&&_()?N.undo():e.metaKey&&89===e.keyCode&&E()&&N.redo()),t.promise()}function i(e){"Range"!==window.getSelection().type&&((32===e.keyCode||13===e.keyCode||8===e.keyCode||j())&&(I=!0,T(!1)),37!==e.keyCode&&38!==e.keyCode&&39!==e.keyCode&&40!==e.keyCode?y(e,f):I=!0,I&&r(l))}function r(e){var t=new $.Deferred;if(null!==e.firstChild){var n=window.getSelection(),o=n.getRangeAt(0),i=g(o,e),r=n.baseOffset;if("Range"===n.type)return t.resolve();if(w(e),j()&&0===r&&"DIV"===n.baseNode.nodeName||!j()&&0===r)return t.promise();p(e,i)}return t.promise()}function d(e){I=e}function a(e){if(f=e,l=document.getElementById(f),"DIV"!==l.nodeName)throw"Editable element must be DIV";$(l).after(O),u(l)}function u(e){e.onkeyup=function(e){i(e)},e.onkeydown=function(e){o(e).then(P(250,e),function(){})},e.onmouseup=function(){r(e).then(P(0,event),function(){})}}Object.defineProperty(n,"__esModule",{value:!0}),"undefined"!=typeof window?window.jquery:"undefined"!=typeof t?t.jquery:null;var f,l,s=e("./caret"),c=s.getCursorCoordinates,p=s.setCaretCharIndex,g=s.getCharacterOffsetWithin,h=e("./highlighting"),y=h.checkHighlighted,w=h.checkEveryTag,m=e("./suggestion"),v=m.getPopUp,C=m.initialisePopover,k=m.listScroll,x=m.destroyPopUp,b=e("./undo_redo"),N=b.stack,E=b.getCanRedo,_=b.getCanUndo,P=b.execute,T=b.setMeta,j=b.getMeta,I=!1,O='<div class=\'popoverContainer\' style=\'position: absolute;\'><a href="#" title="" data-toggle="popover" data-content="" data-placement="bottom"></a> </div>';n.setProcessing=d,n.processKeyDown=o,n.processKeyUp=i,n.process=r,n.makeEditable=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./caret":2,"./highlighting":3,"./suggestion":5,"./undo_redo":6}],5:[function(e,t,n){(function(t){"use strict";function o(e,t,n){m=n,y=$(".popoverContainer")[0],w=$('[data-toggle="popover"]'),v=void 0,C=void 0,w.popover({html:!0,content:x}),y.style.top=e+"px",y.style.left=t+"px",w.popover("show"),k=!0,$(".popover").mouseleave(function(){a(),k=!1}),$(".popover").on("mousedown","a",function(e){e.preventDefault(),v=e.currentTarget.innerText,a(),k=!1,r(document.createTextNode(v)),g(e,m),l(0,e)})}function i(e){var t=e.keyCode,n=$(".list-group-item"),o=n.filter(".selected");return n.removeClass("selected"),13===t&&C?(v=$(C[0]).html(),a(),k=!1,void r(document.createTextNode(v))):(40===t?C=!o.length||o.is(":last-child")?n.eq(0):o.next():38===t&&(C=!o.length||o.is(":first-child")?n.last():o.prev()),void C.addClass("selected"))}function r(e){var t=document.getElementById(m),n=window.getSelection().getRangeAt(0),o=p(n,t);n.insertNode(e),t.normalize(),c(t,o+e.length),h(!0)}function d(){return k}function a(){w.popover("destroy")}var u=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(n,"__esModule",{value:!0});var f=e("./undo_redo"),l=f.execute,s=e("./caret"),c=s.setCaretCharIndex,p=s.getCharacterOffsetWithin,g=e("./highlighting").checkHighlighted,h=f.setExecuteOnInsert;"undefined"!=typeof window?window.jquery:"undefined"!=typeof t?t.jquery:null;u("undefined"!=typeof window?window.jquery:"undefined"!=typeof t?t.jquery:null);"undefined"!=typeof window?window.bootstrap:"undefined"!=typeof t?t.bootstrap:null;var y,w,m,v,C,k=!1,x=$.parseHTML('<div class="list-group"><a href="#" class="list-group-item">Item 1</a><a href="#" class="list-group-item">Item 2</a> <a href="#" class="list-group-item">Item 3</a> <a href="#" class="list-group-item">Item 4</a> <a href="#" class="list-group-item">Item 5</a> </div>')[0];n.getPopUp=d,n.initialisePopover=o,n.listScroll=i,n.destroyPopUp=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./caret":2,"./highlighting":3,"./undo_redo":6}],6:[function(e,t,n){(function(t){"use strict";function o(e){function t(){h=b.canRedo(),y=b.canUndo()}m=document.getElementById(e),c=m.innerHTML,p=Undo.Command.extend({constructor:function(e,t,n,o,i){this.textarea=e,this.oldValue=t,this.newValue=n,this.undoPosition=o,this.redoPosition=i},execute:function(){},undo:function(){this.textarea.innerHTML=this.oldValue,c=m.innerHTML,l(m,this.undoPosition),w=!0},redo:function(){this.textarea.innerHTML=this.newValue,c=m.innerHTML,l(m,this.redoPosition)}}),t(),b.changed=function(){t()}}function i(){return h}function r(){return y}function d(e){x=e}function a(){return x}function u(e){C=e}Object.defineProperty(n,"__esModule",{value:!0});var f=e("./caret"),l=f.setCaretCharIndex,s=f.getCharacterOffsetWithin;"undefined"!=typeof window?window.jquery:"undefined"!=typeof t?t.jquery:null,"undefined"!=typeof window?window.undo:"undefined"!=typeof t?t.undo:null;var c,p,g,h,y,w,m,v=0,C=!1,k=!1,x=!1,b=new Undo.Stack,N=function(e,t){x||((w||!m.hasChildNodes())&&(e=0),clearTimeout(g),g=setTimeout(function(){var e=window.getSelection().getRangeAt(0),n=!1,o=m.innerHTML,i=v,r=s(e,m);return i===r||!C&&13===t.keyCode?void(w=!1):(w?i=b.stackPosition>=0?b.commands[b.stackPosition].redoPosition:b.commands[0].redoPosition:i!==r&&o===c?k?(b.commands[b.commands.length-1].redoPosition=r,n=!0):k=!0:k=!1,n||b.execute(new p(m,c,o,i,r)),c=o,v=r,w=!1,void u(!1))},e))};n.execute=N,n.getCanRedo=i,n.getCanUndo=r,n.stack=b,n.setMeta=d,n.getMeta=a,n.setExecuteOnInsert=u,n.initStack=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./caret":2}]},{},[1])(1)});